# 'title' = "The Designer's Perspective"

h2. Who Are You?

You are the esteemed Web Designer, aesthetically talented and
perhaps artistically inclined. You know what makes a good Web page.
You are not a programmer, though. It's horrible when you have to go
down to the caves where they keep the developers to explain
where a simple login form belongs. You also don't want to 
remember where their odd-looking programming code is supposed to go
in your beautiful page. You want a simple, clean way of describing
the dynamic elements of site pages.

Okay, I've had too much coffee. This page explains how templating
works, and how to put PageTemplate to use when laying out the HTML
of your page.

h2. What's a Template?

When you are designing pages for a dynamic site or Web application,
there are a lot of details you won't know in advance. Some examples
might include login information, the contents of a shopping cart, 
or maybe even the contents of the page! Templates
allow you to put placeholders within your HTML to show where that login
information is displayed and how it is formatted. A good template
system does not require you to remember code while you're designing:
you just make the page, and let programmers worry about filling it with
data.

In PageTemplate, those placeholders are referred to as _directives_.

h2. How Do I Use PageTemplate In My Pages?

PageTemplate uses a simple language which you can embed
in your page. You should be able to use your favorite design tools to
create an attractive template. My favorite design tool happens to be
"GNU/Emacs":/geekery/editors/emacs/index.html, but the odds are that 
the designers out there lean towards something a little friendlier, like 
"Macromedia Dreamweaver":http://www.dreamweaver.com/. With the default syntax, 
all of us can be happy.

PageTemplate directives are indicated by being wrapped in between
@[%@ and @%]@ characters. If any of those characters are missing, PageTemplate 
decides it is not a directive, and leaves it alone.

h3. Variables

The major directives require _variables_, which are just
names for the value your want inserted, checked, or otherwise
accessed. It's a good idea to use variable names that make
sense (@name@ for a person's name, @title@ for the title of the page, etc.).

h3. Value Substitution

Substitution is the easiest concept to master. When PageTemplate
comes across a value directive, it replaces that directive with some text.

h4. Syntax

<pre>
[%var variable %]
</pre>

h4. Example

<pre>
<h1>Hello, [%var name %]</h1>
</pre>

Every time that PageTemplate sees @[%var name %]@ in
your template, it will replace that directive with the text 
associated with @name@.

The programmer works his magic, and the visitor "Frank" sees this
greeting:

<pre><h1>Hello, Frank</h1></pre>

If @name@ is not set, nothing is inserted. The greeting header would end up 
looking like this:

<pre><h1>Hello, </h1></pre>

h3. If

The @if@ directive tells PageTemplate to only display a chunk of content when 
some condition is true. If the condition is not true, PageTemplate skips the 
block and moves on.

h4. Syntax

<pre>
[%if condition %]
chunk
[%endif%]
</pre>

h4. Example

<pre>
[%if pageowner%]
<a href="admin.cgi">Admin</a>
[%endif%]
</pre>

In this example, if the application tells PageTemplate that 
@pageowner@ is true, PageTemplate inserts a link to 
an administrative page. Otherwise, nothing happens here.

h3. If/Else

The @else@ directive adds extra power to @if@, by indicating a chunk of 
content to use when a condition is not true.

h4. Syntax

<pre>
[%if value%] 
chunk 
[%else%]
alternate chunk
[%endif%]
</pre>

h4. Example

<pre>
[%if login%]
<p>Welcome back, [%var login%]!</p>
<p><a href="logout.cgi">Log Out</a></p>
[%else%]
<form name="login" method="post">
Login: <input type="text" name="login" /><br />
Password: <input type="password" name="passwd" /><br />
<input type="submit" value="Login" />
[%endif%]
</pre>

This is the situation where I use @else@ directives the
most. If the visitor is logged in to a Web application, she
is shown a brief welcoming message. If not, then she will see a
login form.

This example also shows a convenient approach to @if@
conditions. We _could_ make up a special @logged_in@
variable, but since all we care about here is the presence of a login,
we have PageTemplate test that as if it were a regular condition.

h3. Unless

Sometimes you only want to display a chunk if something is false, but
nothing if the condition is true. That description twisted my brain
a little bit. Think of it this way. Sometimes it's just easier to say
"unless something" instead of "if not_something". That's all. Templates
should be easy to read, you know? That's what this directive is for:
making some of the logic in your template easier to read.

h4. Syntax

<pre>
[%unless condition %]
chunk
[%end unless%]
</pre>

h4. Example

<pre>
[%unless launched%]
Product Launch Coming Soon!
[%end unless%]
</pre>

h3. In

Use the @in@ directive when you want PageTempate to insert the same chunk 
repeatedly for a list of items. It can grab values from the item to be 
inserted in @value@ directives within the chunk. If there is no list of items, 
the @in@ chunk is skipped.

The @in@ directive is the most complex, and requires more explanation of its 
details.

h4. Syntax

<pre>
[%in list%]
some text and [%var value%]
[%end in%]
</pre>

h4. Example

<pre>
<ul>
[%in books%]
  <li>"[%var title%]" by [%var author%]</li>
[%end in%]
</ul>
</pre>

It presents a list of favorite albums, along with the band that produced it. 
If there was no such list, then PageTemplate would not insert anything, and
we would be left with @<ul></ul>@ all by itself. 
That's more than a little awkward from a designer's point of view, but
the @no@ directive presentd in a few moments helps us work around that.

h4. "Local" Values

When stepping through a list, PageTemplate works a little magic with
@value@ directives. First it examines the list item to see
if it has a value for the variable named. If it can't find one there,
it checks its main variable listing and tries to insert that. If it
can't find a value in the main variable listing, it inserts nothing for
that @value@ directive.

This logic works for nested lists, too. If you have an 
<code>in</code> directive embedded in another <code>in</code> directive,
(say, a list of books written by each one of a list of your favorite
authors), PageTemplate first looks in the innermost list (the books) for
a name, then the next list out (the authors), and finally the main
variable listing.

h4. Loop Metavariables

_Metavariables_ were added in 1.2 so that you can fine-tune your lists, loops, and tables. They are special
flags that are set during certain times in a loop: the first time through, the last time through, during
odd trips through the loop, etcetera. Metavariables are uppercased and wrapped in double underscores to
emphasize that they are not normal variables.

Here are all of the metavariables that are defined in @in@ blocks.

|_. variable  |_. description |
| @__FIRST__@ | true if this is the first time through the loop. |
| @__LAST__@  | true if this is the last time through the loop. |
| @__ODD__@   | true on odd-numbered steps through the loop (1st, 3rd, 5th) |

And to give a little idea of metavariables in action, here's a little example:

<pre>
<table>
<tr><th>#</th><th>Description</th><th>Amount</th></tr>
[%in transactions %]
[%if __ODD__ %]
<tr class="odd">
[%else%]
<tr>
[%endif%]
  <td>[%var num%]</td>
  <td>[%var description%]</td>
  <td>[%var amount%]
</tr>
[%endin%]
</table>
</pre>

h3. In/No

The <code>no</code> directive allows you to use an alternate chunk
for an <code>in</code> if there is no list available.

h4. Syntax

<pre>
[%in list%]
  [%var value%]
[%no%]
  Nothing in the list
[%endin%]
</pre>

h4. Example

<pre>
<ul>
[%in books%]
  <li>"[%var title%]" by [%var author%]</li>
[%no%]
  <li>I have no favorites today.</li>
[%endin%]
</ul>
</pre>

This extends the earlier example by providing an alternate chunk
to use if there is no list named <code>books</code>. Now
the <acronym title="Hypertext Markup Language">HTML</acronym> 
formatting is a little more appropriate. Instead of displaying
an empty list, it shows a list item declaring that there is no list.

I think I hurt my head with that last sentence.

h4. Lists and WYSIWYG Editors

Here's a specific problem that might pop up when you are using
a <acronym title="What You See Is What You Get">WYSIWYG</acronym>
editor. Let's say you're embedding a list into a table, so that each
item in the list gets one table row. Dreamweaver is probably not
going to like this style:

<pre>
<table>
[%in listing%]
  <tr>
    <td>[%var item%]</td>
  </tr>
[%no%]
  <tr>
    <td>Listing is empty</td>
  </tr>
[%endin%]
</table>
</pre>

The problem is that the <code>in listing</code>, <code>no</code>,
and <code>endin</code> directives are in locations that make for 
invalid HTML, and might not be allowed by your editor.

It turns out that the solution is simple, though maybe a little
awkward. Wrap the offending directives in HTML comments, like this
example shows:

<pre>
<table>
<!-- [%in listing%] -->
  <tr>
    <td>[%var item%]</td>
  </tr>
<!-- [%no%] -->
  <tr>
    <td>Listing is empty</td>
  </tr>
<!-- [%endin%] -->
</table>
</pre>

Your fancy editor should be able to handle this, and PageTemplate
should be able to understand it just fine. The only side effect
is that you will have some empty comments in your final page.

The other solution is to use "Vim":/geekery/editors/vim/index.html,
"XEmacs":http://www.xemacs.org/, or some other effective 
non-<acronym title="What You See Is What You Get">WYSIWYG</acronym>
editor. Personal preference, of course. I know that Dreamweaver and GoLive 
cost good money, and you aren't going to toss them aside just because I say 
so. Hopefully this workaround will suit your needs.

h3. Include

The @include@ directive is very simple to use, but it gives you a whole lot of
extra power. It allows you to include content that comes from another
files, including templates. This can be useful when building a page out of 
smaller component templates.

h4. Syntax

<pre>[%include filename %]</pre>

@filename@ can point to a real file in a particular directory, or it could be a
placeholder variable name. If PageTemplate can't find that file, it displays a simple message stating
that the file was not found. The idea for this is to make it easier for developers to debug problems during
testing, rather than for you to wonder why there's a blank space where your menu text should be.

h4. Example

<pre>
[%include menu %]
</pre>

Meanwhile, we have something like this in <em>menu.txt</em>

<pre>
<table>
[%in photos%]
  <tr>
    <td>[%var title%]</td>
    <td>[%var thumbnail %]</td>
  </tr>
[%endin%]
</table>
</pre>

Do you see what I meant when I said "simple"? If not, then please let me know.
I'm still working on this part of the manual.

h3. Comments

Every once in a while you want to make a comment about your template, but not have it show up the 
HTML markup that goes to the visitor. Comments are perfect for that. They are eaten up and spit aside
by PageTemplate when reading your template file, and the visitor never sees them.

h4. Syntax

<pre>
[%-- comment --%]
</pre>

h2. Customized Syntax

One of PageTemplate's features is the ability to come up with your
own directive syntax. If you feel that the default syntax is
less than ideal, discuss a new system with your developers. If
you are the lone designer/developer, talk to yourself for a bit. We
all need some quality time to ourselves occasionally. Working together,
you and the developers <em>(or you and your split personalities)</em>
can come up with a syntax that is much more comfortable.

h2. Conclusion

Yes, we've already reached the end of this designer's tutorial.
Now go make with the pretty pages!
